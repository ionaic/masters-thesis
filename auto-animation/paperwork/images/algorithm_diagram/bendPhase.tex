\begin{tikzpicture}[node distance = 1em, auto]
 % Place nodes
	\node [data, below of=path] (accel) {\nodebox{6em}{Target Acceleration ($a$)}};
    
    % Bend Phase
    %	Bend Stage
    % before controller, need to calculate the desired force
    \node [lvl2, below=7em of accel] (forceCalc) {\nodebox{12em}{Calculate desired force $F_{target} = \displaystyle\sum_{j=0}^n {m_j} a$}};
    \node [lvl3, below=7em of forceCalc] (bendErr) {Calculate error from desired force magnitude ($E_{force}$)};
    \node [lvl3, right=of bendErr] (bendBal) {Calculate balance error ($E_{balance}$)};
    \node [data, below right=1em and -1em of bendErr] (bendErrAll) {\nodebox{12em}{$E_{all} = E_{force} + E_{balance}$}};
    \node [decision, below=2em of bendErrAll] (bendPDTest) {$E_{all} \overset{?}{\le} \epsilon$};
    \node [lvl3, left=8em of bendPDTest] (bendPDeq) {$u(i) = k_p E_{all}(i) + k_d \left(E_{all}(i) - E_{all}(i-1)\right)$};
    \node [title, above right=3em and -2.5em of bendErr] (bendPDtitle) {PD Controller};
    \node [lvl2, fit=(bendPDtitle) (bendErr) (bendBal) (bendErrAll) (bendPDeq) (bendPDTest)] (bendPD) {};
    \node [title, right=of forceCalc] (bendTitle) {Bend Phase};
    \node [lvl1, fit=(forceCalc) (bendTitle) (bendPD)] (bend) {};
    %	Bend Data
    \node [data, left=1em of accel] (mass) {\nodebox{7em}{Body Mass assigned to each limb ($\left\lbrace m_0, \ldots, m_n\right\rbrace$)}};
	\node [data, left=10em of accel] (skeleton) {\nodebox{6em}{Model with skeleton attached ($J = \left\lbrace j_0, \ldots, j_n \right\rbrace$, contains at least a pelvis and both left and right hips, knees, ankles, heels, and toes)}};
	\node [data, below=2em of skeleton] (mjoints){\nodebox{7em}{Muscled joints ($J_m = \lbrace$ $j_{pelvis}$, $j_{Lhip}$, $j_{Rhip}$, $j_{Lknee}$, $j_{Rknee}$, $j_{Lankle}$, $j_{Rankle}$, $j_{Lheel}$, $j_{Rheel}$, $j_{Ltoe}$, $j_{Rtoe}$ $\rbrace$}};
	\node [data, right=4em of accel] (muscles) {\nodebox{7em}{Muscle spring constant for muscled joints ($\left\lbrace k_0, \ldots, k_11\right\rbrace$)}};
	\node [data, right=2em of muscles] (jconst) {\nodebox{5em}{Rotation constraints for joints ($\theta_{min}, \theta_{max}$ $\forall j \in J_{muscled}$)}};
	
	\path [line] (accel) -- (forceCalc);
    \path [line] (mass) |- (forceCalc);
    \path [line] (forceCalc) -- (bendErr);
    \path [line] (bendErr) |- (bendErrAll);
    \path [line] (bendBal) |- (bendErrAll);
    \path [line] (bendErrAll) -- (bendPDTest);
    \path [line] (bendPDTest) -- (bendPDeq);
    \path [line] (bendPDeq) -- ++(0em, 17em) -| (bendBal);
    \path [line] (bendPDeq) |- (bendErr);
\end{tikzpicture}